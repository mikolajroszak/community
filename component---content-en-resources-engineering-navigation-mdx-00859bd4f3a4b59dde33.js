(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{XQQs:function(e,t,n){"use strict";n.r(t),n.d(t,"_frontmatter",(function(){return l})),n.d(t,"default",(function(){return b}));var a,o=n("zLVn"),r=(n("q1tI"),n("7ljp")),i=n("lvnj"),l={},s=(a="CTA",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),Object(r.b)("div",e)}),c={_frontmatter:l},h=i.a;function b(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(r.b)(h,Object.assign({},c,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("h1",{id:"navigation-automagic"},"Navigation Automagic"),Object(r.b)("p",null,"While there are many great gatsby-starters out there for documentation, we decided\nto build our own from scratch because we needed to satisfy a number of requirements\nunique to decentralized projects, which include: handling multiple languages easily and\nmaking it as easy as possible for content contributors to write and adapt the site\nas they see fit without requiring them to learn React."),Object(r.b)("p",null,"Our philosophy is ",Object(r.b)("strong",{parentName:"p"},'"content creators write the website"'),", which means that we\nhave put a lot of thought and effort into how navigation, translations and 404 pages work\nand how non-developers can control all these things using nothing more than mdx."),Object(r.b)("h2",{id:"the-sidenav"},"The Sidenav"),Object(r.b)("p",null,"Each top level section (Funding, Learn, Contribute) has it's own directory displayed\nin the form of a vertical ",Object(r.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/makerdao/community-portal/tree/r2d/src/modules/navigation"}),"sidenav"),".\nThis sidenav has very specific features:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"Auto-magically generated links based on existing file structure of top level section"),Object(r.b)("li",{parentName:"ol"},"Recursively intelligent"),Object(r.b)("li",{parentName:"ol"},"Support for multiple languages"),Object(r.b)("li",{parentName:"ol"},'Default locale ("en") fills in the gaps for missing pages when on a different locale page')),Object(r.b)("p",null,"To do this, we leverage Gatsby's file-source querying with a graphql regex filter to get every\nsingle page in the entire content folder (this sounds expensive, but it's only run once\nin the form of a static query during build time). We then pull in the edges and convert\nthat data into something usable in the form of a sidenav."),Object(r.b)(s,{mdxType:"CTA"},Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"We get"),": uglified data in one array."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"We need"),": an array of objects that can contain recursive layer of children",Object(r.b)("br",{parentName:"p"}),"\n","(i.e. the sidenav needs to look exactly like the file structure).")),Object(r.b)("p",null,"We used parts of the ",Object(r.b)("a",Object.assign({parentName:"p"},{href:"https://github.com/hasura/gatsby-gitbook-starter"}),"hasura/gastsby-gitbook-starter"),"\nas a reference for how to logically put this together."),Object(r.b)("p",null,"To keep it short, there's a file called ",Object(r.b)("inlineCode",{parentName:"p"},"Sidenav_Tree")," that exports a method that\nconverts the MDX edge data into {title, slug, rawSlug} (rawSlug being the file path without it's locale)\nand only returns elements for the locale specified and our currentTopSection (Learn, Contribute, Funding, etc.).\nWe convert this into sidenav objects for our default locale and our current locale\n(if our current locale is the same as the default we don't make objects for it).\nThen we merge overlap the locale files over the default locale files."),Object(r.b)("p",null,"After we've gotten our ",Object(r.b)("inlineCode",{parentName:"p"},"mergedLocaleFiles")," we reduce all them using some of the sidenav example\nfrom the hasura starter to generate an object ",Object(r.b)("inlineCode",{parentName:"p"},"items")," that contain more items\n(tl;dr: our sidenav in object/array form)."),Object(r.b)("p",null,"Our Tree component then takes that data, and renders our ",Object(r.b)("inlineCode",{parentName:"p"},"Sidenav_Node")," component by mapping\nthrough all of the elements."),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"Importantly"),", content creators can specify an ",Object(r.b)("inlineCode",{parentName:"p"},"order")," in the frontmatter of their files which\nis taken into account by the algorithm in ",Object(r.b)("inlineCode",{parentName:"p"},"Sidenav_Tree"),' and will determine the order in which links\nto different pages appear in the sidenav (otherwise this would happen alphabetically, which is not\nideal). The "order" number can range from -infinity -> infinity, and pages will be ordered\nrelative to their siblings based on these simple rules:'),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"If order exists in a file it will always be above files without order."),Object(r.b)("li",{parentName:"ol"},"The lower the order number, the higher it is in the list. 0 -> 10 is Top -> Bottom"),Object(r.b)("li",{parentName:"ol"},"If relative files have the same order (ie. human error) then they will be sorted alphabetically of their Title."),Object(r.b)("li",{parentName:"ol"},"Files without order are sorted in alphabetical order of their title (Title rule applies, localeCompare is used for non english characters).")),Object(r.b)("h2",{id:"breadcrumbs"},"Breadcrumbs"),Object(r.b)("p",null,"Breadcrumbs are very simple. They are aware of their location in the app, run a query to get all the MDX,\nand then breaks down the data blob based on our current route to produce an array of objects to be rendered."),Object(r.b)("p",null,"You would think that we could just utilize the route/uri and convert those, however this solution doesn't\ncover every edge case. Based on our specs, the expectation is that the Breadcrumb labels will match the\ntitle (keeping to the Title Rule). So we HAVE to pull down their path, frontmatter, and headings to generate\nthe title and url for the label."),Object(r.b)("p",null,"It will look something like this:\n",Object(r.b)("strong",{parentName:"p"},"Home / Learn / Bounties / ... / ... / ... / ... / Page we're on")),Object(r.b)("p",null,"Note: If we're more than 3 levels deep in directories then our specs showed that we need to display\nellipsis in place of their full title. They are still clickable links though."),Object(r.b)("h2",{id:"404s"},"404s"),Object(r.b)("p",null,'Following the philosophy of "content creators write the website" means we should allow them to\nwrite 404 pages as well. Yes, from a developer standpoint this sounds outlandish, but because our\ncontent (specifically our translations) are all encapsulated in the content folder it should stay that way\n(instead of having translators bounce into code to fix the 404 page).'),Object(r.b)("p",null,"The solution is to have one 404.js page live in the ",Object(r.b)("inlineCode",{parentName:"p"},"src/pages")," directory, which performs a static query to\npull down all ",Object(r.b)("inlineCode",{parentName:"p"},"404.mdx")," pages at the top level of a locale folder, i.e. ",Object(r.b)("strong",{parentName:"p"},"content/locale(en)/404.mdx"),".\nSimilarly to ",Object(r.b)("inlineCode",{parentName:"p"},"header.mdx")," files we then render the body of the current locale mdx content."),Object(r.b)("p",null,"If no 404 exists for the current locale we default to en. If no en 404 exists, we use an inline developer 404 page."))}b.isMDXComponent=!0}}]);
//# sourceMappingURL=component---content-en-resources-engineering-navigation-mdx-00859bd4f3a4b59dde33.js.map